<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      margin: 0;
      background-color: #f4f4f4;
    }

    .form-container {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      width: 300px;
    }

    .form-container label {
      /* font-weight: bold; */
      display: block;
      margin-bottom: 5px;
    }

    .form-container label.required:after {
      content: " *";
      color: red;
    }

    .form-container input,
    .form-container select {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    .form-container button {
      background-color: #4285f4;
      color: #fff;
      border: none;
      padding: 10px;
      width: 100%;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }

    .form-container button:hover {
      background-color: #357ae8;
    }
  </style>
</head>

<body>
  <div class="form-container">
    <form id="form">
      <label for="first-name" class="required">First Name</label>
      <input type="text" id="first-name" name="first-name" required />

      <label for="last-name" class="required">Last Name</label>
      <input type="text" id="last-name" name="last-name" required />

      <label for="email" class="required">Email</label>
      <input type="email" id="email" name="email" required />

      <label for="product" class="required">Product</label>
      <select id="product" name="product" required>
        <option label="Ensora Mental Health | Theranest" value="TheraNest Professional" selected>
          Ensora Mental Health | Theranest
        </option>
        <option label="Ensora Rehab Therapy | Fusion" value="Ensora Rehab Therapy/Fusion">
          Ensora Rehab Therapy | Fusion
        </option>
        <option label="Ensora Rehab Therapy | Fusion Enterprise" value="Ensora Rehab Therapy/Fusion Enterprise">
          Ensora Rehab Therapy | Fusion Enterprise
        </option>
        <option label="Ensora ABA Therapy | WebABA Pro & Group" value="Ensora ABA Therapy/WebABA Pro & Group">
          Ensora ABA Therapy | WebABA Pro & Group
        </option>
        <option label="Ensora Clearinghouse | Apex" value="Ensora Clearinghouse/Apex">
          Ensora Clearinghouse | Apex
        </option>
        <option label="Ensora Data Collection | Catalyst" value="Ensora Data Collection/Catalyst">
          Ensora Data Collection | Catalyst
        </option>
        <option label="Ensora Centralized Billing | Logik" value="Ensora Centralized Billing/Logik">
          Ensora Centralized Billing | Logik
        </option>
        <option label="Ensora eRx | NewCrop" value="Ensora eRx/NewCrop">
          Ensora eRx | NewCrop
        </option>
        <option label="ShareNote by Ensora Health" value="ShareNote by Ensora Health">
          ShareNote by Ensora Health
        </option>
        <option label="TenEleven by Ensora Health" value="TenEleven by Ensora Health">
          TenEleven by Ensora Health
        </option>
        <option label="EchoVantage by Ensora Health" value="EchoVantage by Ensora Health">
          EchoVantage by Ensora Health
        </option>
        <option label="Procentive by Ensora Health" value="Procentive by Ensora Health">
          Procentive by Ensora Health
        </option>
        <option label="MyClients Plus 2.0 by Ensora Health" value="MyClients Plus 2.0 by Ensora Health">
          MyClients Plus 2.0 by Ensora Health
        </option>
        <option label="MyClients Plus 3.0 by Ensora Health" value="MyClients Plus 3.0 by Ensora Health">
          MyClients Plus 3.0 by Ensora Health
        </option>
        <option label="CodeMetro by Ensora Health" value="CodeMetro by Ensora Health">
          CodeMetro by Ensora Health
        </option>
        <option label="Thera-LINK" value="Thera-LINK">Thera-LINK</option>
        <option label="KASA" value="KASA">KASA</option>
        <option label="WebABA Legacy" value="WebABA Legacy">WebABA Legacy</option>
        <option label="AccuPoint Legacy" value="AccuPoint Legacy">AccuPoint Legacy</option>
        <option label="RevMan" value="RevMan">RevMan</option>
        <option label="ShareCare" value="ShareCare">ShareCare</option>
        <option label="Clinician's Desktop" value="Clinician's Desktop">
          Clinician's Desktop
        </option>
        <option label="Insyst" value="Insyst">Insyst</option>
      </select>


      <label for="business" class="required">Business Impact</label>
      <select id="business" name="business" required>
        <option label="I have a question about my product" value="I have a question about my product">
          I have a question about my product
        </option>
        <option label="There is an item causing some minor annoyances (everyone can still work)"
          value="There is an item causing some minor annoyances (everyone can still work)">
          There is an item causing some minor annoyances (everyone can still
          work)
        </option>
        <option label="Part of the system is not functioning (some people cannot work)"
          value="Part of the system is not functioning (some people cannot work)">
          Part of the system is not functioning (some people cannot work)
        </option>
        <option label="Entire system is down (no one can work)" value="Entire system is down (no one can work)">
          Entire system is down (no one can work)
        </option>
      </select>

      <label for="subject" class="required">Subject</label>
      <input type="text" id="subject" name="subject" required />

      <label for="description" class="required">Brief Description</label>
      <input type="text" id="description" name="description" required />

      <button type="submit">Start Chatting</button>
    </form>
  </div>
  <script>
    const form = document.getElementById("form");
    const formFields = form.querySelectorAll("input, select, textarea");
    const submitButton = document.querySelector("button[type='submit']");

    const url = new URL(window.location.href);

    const firstName = url.searchParams.get("firstName");
    const lastName = url.searchParams.get("lastName");
    const userEmail = url.searchParams.get("email");
    const product = url.searchParams.get("product");
    // console.log(`${firstName} ${lastName} ${userEmail}`)

    const firstNameField = document.getElementById("first-name");
    const lastNameField = document.getElementById("last-name");
    const emailField = document.getElementById("email");
    const productField = document.getElementById("product");

    if (firstName) {
      firstNameField.value = firstName;
      firstNameField.disabled = true;
    }
    if (lastName) {
      lastNameField.value = lastName;
      lastNameField.disabled = true;
    }
    if (userEmail) {
      emailField.value = userEmail;
      emailField.disabled = true;
    }
    if (product) {
      productField.value = product;
      productField.disabled = true;
    }

    document
      .getElementById("form")
      .addEventListener("submit", function (event) {
        event.preventDefault(); // Prevents form submission for demonstration
        const firstName = document.getElementById("first-name").value;
        const lastName = document.getElementById("last-name").value;
        const email = document.getElementById("email").value;
        // const organization = document.getElementById("organization").value;
        const product = document.getElementById("product").value;
        const business = document.getElementById("business").value;
        const subject = document.getElementById("subject").value;
        const description = document.getElementById("description").value;

        window.parent.postMessage(
          JSON.stringify({
            event_code: "ym-client-event",
            data: JSON.stringify({
              event: {
                code: "userdetails",
                data: {
                  firstName,
                  lastName,
                  email,
                  product,
                  business,
                  subject,
                  description,
                },
              },
            }),
          }),
          "*"
        );
        console.log("event submitted");
        console.log(JSON.stringify({
          event: {
            code: "userdetails",
            data: {
              firstName,
              lastName,
              email,
              product,
              business,
              subject,
              description,
            },
          },
        }))

        formFields.forEach((field) => {
          field.disabled = true;
        });
        submitButton.disabled = true;
        // alert(`${name} ${email} ${phone} ${organization} ${product} ${business} ${subject} ${description}`);
      });
  </script>
</body>

</html>